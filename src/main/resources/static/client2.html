<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://cdn.bootcss.com/socket.io/2.2.0/socket.io.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
<h1 id="message">connecting...</h1>
<div id="question"></div>
<br/>
<div id="countdown"></div>
<br/>
<hr/>
<div id="answers"></div>
<br/>


<script>
    const challengeId = 219;

    const token = "Bearer " + "eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJzdHVkZW50MjE1IiwiZXhwIjoxNjM3OTk3Mjc5LCJpYXQiOjE2Mzc2MzcyNzl9.bCVitCST689Pl5vFfArNC27e36rpnD7963H-Nj4wnMk";

    // const socketurl = "http://159.223.38.181:8082";
    const socketUrl = "http://localhost:8082"
    const socket = io.connect(socketUrl, {
        query: "challengeId=" + challengeId
    });

    socket.on("connected", (data) => {
        $("#message").append("<br/><b> " + data + "</b>");
    });

    // handle publish question event
    socket.on("publishQuestion", (data) => {
        const question = data.id + ":" + data.ordinalNumber + " Ask date: " + data.askDate + "<br/> <img height='200px' src='" + data.questionContent + "'/> <br/>" + data.answerTimeLimit + " " + data.point + " " + data.answerOption;
        document.getElementById("question").innerHTML = question;
        let answersText = "";
        let answers = [];
        data.publishAnswerResponses.forEach(e => {
            answersText += "<button class='answer' data-id='" + e.id + "'>" + e.id + ":" + e.ordinalNumber + ". " + e.answerContent + "</button>";
        });
        document.getElementById("answers").innerHTML = answersText;


        clearInterval(downloadTimer);

        countdown(data.answerTimeLimit)
    });


    var downloadTimer;

    function countdown(timeleft) {

        downloadTimer = setInterval(function () {
            if (timeleft <= 0) {
                clearInterval(downloadTimer);
                document.getElementById("countdown").innerHTML = "Finished";
            } else {
                document.getElementById("countdown").innerHTML = timeleft + " seconds remaining";
            }
            timeleft -= 1;
        }, 1000);
    }

    function sendAnswer(answerId){

    }


</script>
</body>
</html>